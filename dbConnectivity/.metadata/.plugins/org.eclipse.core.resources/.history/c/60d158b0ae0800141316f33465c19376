package mongodbConnectivity;

import java.net.UnknownHostException;
import java.util.Set;

import com.mongodb.BasicDBObject;
import com.mongodb.DB;
import com.mongodb.DBCollection;
import com.mongodb.DBObject;
import com.mongodb.MongoClient;

public class DbConnectivity {

	public static void main(String[] args) throws UnknownHostException {
		MongoClient mongoclient = new MongoClient("localhost", 27017);
		
		DB db = mongoclient.getDB( "mydb" );
		
		BasicDBObject doc = new BasicDBObject("name","Aayush");
		doc.append("class",10);
		BasicDBObject doc1 = new BasicDBObject("name","Sameer");
		doc.append("class",20);
		
		
		db.createCollection("newCollection", doc);
		
		Set<String> colls = db.getCollectionNames();
		for(String s : colls)
		{
			System.out.println(s);
		}
		
		
		
		DBCollection dbnewCollection = db.getCollection("newCollection");
		dbnewCollection.insert(doc1);
		
		DBObject docz = dbnewCollection.findOne();
		System.out.println(docz);
		
		System.out.println("Done!!");
		mongoclient.close();
	}

}
